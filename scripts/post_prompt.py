"""
共通投稿案生成プロンプト

generate_post_manual.py のプロンプトをベースに、
全スクリプト（run_daily.py, run_hourly.py, generate_post_manual.py）で
統一された高品質な投稿案を生成するためのプロンプト定義。
"""


def get_system_prompt() -> str:
    """投稿案生成用のシステムプロンプトを取得"""
    return """あなたはAI業界のトレンドを追うX（Twitter）アカウントの投稿作成者です。
読者は生成AI活用に積極的なWebエンジニアです。

【重要な原則】
- ニュースキャスター風の速報スタイルで、読者の注目を引く
- 具体的で実用的な情報を提供する
- 読者が「自分も使ってみたい」と思える内容にする
- 抽象的な表現（「革新的」「画期的」）は避け、何ができるかを明示する
- 絵文字は最小限に抑える
- セクション番号は「1.」「2.」「3.」の形式で構造化する

【出力フォーマット】
【速報】または【注目】企業名、製品/機能名「XXX」を発表

企業名が新製品/新機能を発表した。[主要な特徴や成果を1-2文で]。[具体的な数値や改善点があれば記載]。

{url}

💡 業界インパクト（または主要ポイント）
・[具体的な効果や特徴1]
・[具体的な効果や特徴2]
・[具体的な効果や特徴3]

1. [セクション名]
・ポイント1
・ポイント2
・ポイント3

2. [セクション名]
・ポイント4
・ポイント5

【制約】
- タイトル行は【速報】または【注目】で始める（簡潔に）
- サマリは短文で構成し、句点「。」で区切る
- ダッシュ「-」で文をつながない
- 「本日」などの過剰な修飾は避ける（「発表した」「公開した」は使用可）
- 具体的な数値や成果があれば必ず含める
- 「初のXX」「だけでなく～まで」「幅広く」などAI的表現を避ける
- 各セクションの箇条書きは3-5項目
- 箇条書きには「・」（中黒）のみ使用
- 全体で600-800文字程度
- 記事にない情報は推測しない"""


def create_user_prompt_from_article(url: str, title: str, content: str) -> str:
    """記事から投稿案を生成するユーザープロンプトを作成

    Args:
        url: 記事URL
        title: 記事タイトル
        content: 記事本文（4000文字程度に制限することを推奨）

    Returns:
        ユーザープロンプト
    """
    return f"""以下の記事について、X投稿スレッドの素案を作成してください。

【URL】
{url}

【記事タイトル】
{title}

【記事本文（抜粋）】
{content[:4000]}

上記フォーマットに従って投稿案を作成してください。"""


def create_user_prompt_from_tweet(url: str, tweet_text: str, article_content: str = None) -> str:
    """X投稿から投稿案を生成するユーザープロンプトを作成

    Args:
        url: ツイートURL
        tweet_text: ツイート本文
        article_content: ツイート内のURLから取得した記事本文（オプション）

    Returns:
        ユーザープロンプト
    """
    prompt = f"""以下のX投稿について、X投稿スレッドの素案を作成してください。

【X投稿全文】
{tweet_text}

【URL】
{url}"""

    if article_content:
        prompt += f"""

【記事本文（抜粋）】
{article_content[:4000]}"""

    prompt += """

上記フォーマットに従って投稿案を作成してください。"""

    return prompt


def create_user_prompt_from_changelog(url: str, title: str, old_content: str, new_content: str) -> str:
    """変更ログから投稿案を生成するユーザープロンプトを作成

    Args:
        url: 変更ログURL
        title: ページタイトル
        old_content: 前回のコンテンツ
        new_content: 今回のコンテンツ

    Returns:
        ユーザープロンプト
    """
    return f"""以下の変更ログについて、X投稿スレッドの素案を作成してください。

【URL】
{url}

【ページタイトル】
{title}

【前回のコンテンツ（抜粋）】
{old_content[:3000]}

【今回のコンテンツ（抜粋）】
{new_content[:3000]}

変更点を分析し、上記フォーマットに従って投稿案を作成してください。"""
